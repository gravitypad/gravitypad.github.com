

<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>gravitypad.com</title>
  <meta name="author" content="paul kearney">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <link rel="openid.server" href="http://www.myopenid.com/server">
  <link rel="openid.delegate" href="http://paulkearney.myopenid.com/">

  
    
  
  <meta name="description" content=" ">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://gravitypad.github.com/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="gravitypad.com" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="gravitypad.com" />
  <meta name="og:title" content="gravitypad.com" />
  <meta name="og:description" content=" " />
  <meta name="og:url" content="http://gravitypad.github.com/blog/page/2/index.html"/>
  <meta name="url" content="http://gravitypad.github.com/blog/page/2/index.html">
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <div id="front-wrapper">
  <div id="hero">
    <div id="hero-inner" class="container">
      <div class="span10 offset1">
  <h1>
    hi, i&#8217;m <em>paul kearney</em>
  </h1>
  <h2>
  	a .net developer/architect, technologist, and all around good guy
  </h2>
</div>

    </div>
  </div>
  <section id="sub-hero">
    <div class="container">
      <div class="row">
  <div class="span4">
    <h2>about me</h2>
<p>Been doing software development since the 1900&#8217;s. 
<a href="/about-me/index.html">Read more&#8230;</a></p>
  </div>
  <div class="span8">
      <h1>popular posts</h1>
  <ul id="popular_posts">
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li class="post">
        <a href="/blog/2010/09/03/resolving-tfs-error-tf14087-cannot-undelete-x-because-not-all-of-the-deletion-is-being-undeleted/">Resolving TFS error TF14087: Cannot undelete X because not all of the deletion is being undeleted</a>
      </li>
      
    
      
      <li class="post">
        <a href="/blog/2010/05/26/my-love-affair-with-windbg-or-high-cpu-utilization-in-asp-dot-net-and-the-runaway-iterator/">My love affair with WinDbg (or high CPU utilization in ASP.Net and the runaway iterator)</a>
      </li>
      
    
      
      <li class="post">
        <a href="/blog/2010/02/09/reclaiming-disk-space-from-outlook-ost-files/">Reclaiming disk space from Outlook OST files</a>
      </li>
      
    
      
    
  </ul>

  </div>
</div>

    </div>
  </section>
  <div class="container">
    <div class="row" id="post-container">
    
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/15/a-thank-you-from-caleb-and-the-st-baldricks-foundation/">A Thank You From Caleb and the St. Baldrick’s Foundation</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2011-03-15T00:00:00-07:00" pubdate data-updated="true">Mar 15<span>th</span>, 2011</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>Thank you all again for making my head-shaving event so incredibly successful. At the last minute, &#8220;Phoebe&#8221; donated $50, bringing our total to $11,500&#8211;exactly $4000 more than I had set as a goal! Imagine my surprise when I checked the site tonight and saw that another $250 had come in! And with the matching gifts that will trickle in, St. Baldrick&#8217;s made more than $17,000 from my one silly haircut.</p>

<p>While I&#8217;m sorry to have missed the party at Fado&#8217;s, I&#8217;m glad we did it at home: Phoebe had a ton of fun sitting on my lap and cutting off individual curls to put in a bag. The curls will go out to the fairy garden tomorrow so that the faries can use them for beds.</p>

<p>Thank you all again, and don&#8217;t be too surprised if you hear from me again in a year&#8230;</p>

<p><img src="/images/posts/caleb/1.jpg" alt="" /></p>

<p>Cheers, Caleb</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/02/24/the-fro-must-go/">The Fro Must Go</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2011-02-24T00:00:00-08:00" pubdate data-updated="true">Feb 24<span>th</span>, 2011</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>From my friend Caleb:</p>

<p>As many of you know, my daughter is battling a rare and aggressive form of brain cancer. We’ve been fighting it for 2 years now, and continue to do so. One thing that’s become apparent is that there just hasn’t been enough money put into pediatric cancer research. St. Baldrick’s Foundation is a non-profit foundation that has donated more money to pediatric cancer research than anyone else (except for the government). To date, they’ve raised and granted more than $56 million. The remarkable thing is that they do this by getting people like me to shave their heads—and people like you to be of a generous spirit (you can see where this is going, can’t you?)</p>

<p>While “shaving events” happen year-round, the big events tend to be around St. Patrick’s Day. In Seattle, the event is at Fado Irish Pub, and is 2 weeks from today (march 10th). I just found out yesterday, and have decided to set an ambitious goal&#8211;$7500 in 2 weeks.  If you feel inspired to make a donation, please do so. As you can see from the photo on my page, my hair has become rather unruly, making the change to a shaved head more dramatic. As my wife has been saying, “the ‘fro must go!”, and what better way to get shorn?</p>

<p>Thanks!
Caleb</p>

<p><img src="/images/posts/caleb/2.jpg" alt="" /></p>

<p><a href="http://www.stbaldricks.org/participants/calebthompson">http://www.stbaldricks.org/participants/calebthompson</a></p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/02/10/new-developer-blog/">New Developer Blog</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2011-02-10T10:19:00-08:00" pubdate data-updated="true">Feb 10<span>th</span>, 2011</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>We just launched a new developer blog over at msnbc.com: Development @ msnbc. We are covering a bunch of different aspects about software development, from technical nitty-gritty on how we build and operate the software that runs our family of websites to philosophical perspectives on the softer side of development.</p>

<p>Head over there and check it out. We have several authors writing there, including John Bennett, Bryan Wheeler and Peter Durham (and yours truly).</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/02/08/giving-back/">Giving Back</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2011-02-08T00:00:00-08:00" pubdate data-updated="true">Feb 8<span>th</span>, 2011</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a slightly modified version of a post I made at <a href="http://development.msnbc.msn.com">Development@msnbc</a>.</p>

<p>I&#8217;m a big fan of serving my community and supporting non-profit organizations. Serving is in our DNA as humans. We give birthday presents, give rides to the airport, cook a meal for someone in need, give time to mow someone&#8217;s lawn, give our money to causes we believe in. We serve in various capacities in our communities, our churches, or maybe sit on the board of a non-profit organization. We do it because we believe it is the right thing to do. I believe we do it because it is an integral part of our beings.</p>

<p>There&#8217;s so many organizations doing great and wonderful things for our communities and individuals throughout the world. Some of those organizations are large, well funded, and probably have good sized technology organizations to help support them. But there&#8217;s a large number of organizations out there that are small, struggling to figure out how to spend their limited money in the most effective way for their mission.</p>

<p>A few weeks ago I participated in <a href="http://www.seattlegivecamp.org">Seattle GiveCamp</a>. It was a part of a larger GiveCamp weekend happening in 14 cities across the United States. 2011 was the fourth year GiveCamp has been held, and there were more projects built for non-profit organizations this year than had been built in the previous three years combined. In Seattle, we had 50 volunteers working on 22 projects for 20 different local charities. We started at 5PM on Friday night and wrapped up at 5PM Sunday. My co-worker <a href="http://www.jtbennett.com">John Bennett</a> was also signed up for the GiveCamp happening in NYC.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2011/02/08/giving-back/">Read on &rarr;</a>
    </footer>
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/01/06/nsosumi-a-c-number-port-of-a-mobileme-scraper/">nSosumi: A C# Port of a MobileMe Scraper</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2011-01-06T00:00:00-08:00" pubdate data-updated="true">Jan 6<span>th</span>, 2011</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a C#/.Net port of Sosumi by Tyler Hall. Tyler&#8217;s original PHP project can be found here: <a href="https://github.com/tylerhall/sosumi">https://github.com/tylerhall/sosumi</a></p>

<p>nSosumi will allow you to programmatically retrieve your iOS device&#8217;s current location, send it a message/play a sound, remotely lock or remotely wipe your iOS device. I&#8217;ve tested it with my iPhone 4&#8217;s and an iPad, all running iOS 4.2.</p>

<p>You can find the source here: <a href="http://code.google.com/p/nsosumi">http://code.google.com/p/nsosumi</a>. I&#8217;ll be providing more details soon.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/09/03/resolving-tfs-error-tf14087-cannot-undelete-x-because-not-all-of-the-deletion-is-being-undeleted/">Resolving TFS Error TF14087: Cannot Undelete X Because Not All of the Deletion Is Being Undeleted</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2010-09-03T10:31:00-07:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2010</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>At work, we recently encountered this error in TFS when trying to merge from our trunk into a project branch. There&#8217;s <a href="http://stackoverflow.com/search?q=tf14087">some</a> <a href="http://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol/thread/b1be6b2b-f17a-49d6-ae0e-207ad9b10b6f">information</a> on the <a href="http://blogs.msdn.com/b/mrod/archive/2006/10/10/the-logic-and-reason-behind-error-message-tf14087.aspx">internet</a> about this <a href="http://geekswithblogs.net/svanvliet/archive/2007/01/14/team-foundation-server-merge-woes-tf14087.aspx">error</a>, but none of them directly applied to our issue. Thankfully, one of the benefits of having Microsoft as a parent company is access to TFS engineers.</p>

<p>We got into this situation when someone deleted a folder in the trunk and then re-added a folder with the same name. And then deleted it. And re-added it. When you do this without merging between the delete and adds, TFS gets real confused. It tries to merge the delete and the add (and in our case, the second delete and second add), and because they are all the same name and path, you get TF14087.</p>

<p>The solution (thanks George) was pretty simple:
Get the deleted id for all of the deletes of the folder:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tf dir /recursive /deleted /slotmode $/project/trunk. </span></code></pre></td></tr></table></div></figure>


<p>This gives output like:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$/project/trunk:
</span><span class='line'>$Build
</span><span class='line'>$Configs
</span><span class='line'>$Databases
</span><span class='line'>$Deploy
</span><span class='line'>$Docs
</span><span class='line'>$External
</span><span class='line'>$Folder
</span><span class='line'>$Folder;X246937
</span><span class='line'>$Folder;X246938</span></code></pre></td></tr></table></div></figure>


<p>In our case, there are three entries for $Folder, two with deleted ids, and the one folder that has not been deleted (the last add).
Destroy the deleted folders by using their deleted ids.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tf destroy /preview $/ijv/trunk/folder;X246937</span></code></pre></td></tr></table></div></figure>


<p>Adding the /preview argument let&#8217;s you confirm what would be done when issuing the destroy command. After you review the output and make sure you&#8217;re not destroying something you don&#8217;t mean to, remove the /preview and run the command.</p>

<p>Then we run it for the other deleted id:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tf destroy /preview $/ijv/trunk/folder;X246938</span></code></pre></td></tr></table></div></figure>


<p>Finally, do the merge from the trunk back into the project branch.
That resolved the issue for us. We lost the history of the original two versions of that folder, but it did allow us to move forward with merging. Hopefully this information will help someone when trying to resolve the same issue.</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/05/26/my-love-affair-with-windbg-or-high-cpu-utilization-in-asp-dot-net-and-the-runaway-iterator/">My Love Affair With WinDbg (or High CPU Utilization in ASP.Net and the Runaway Iterator)</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2010-05-26T00:00:00-07:00" pubdate data-updated="true">May 26<span>th</span>, 2010</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>A while back I attended a “Debugging .Net Applications” course taught by John Robbins from Wintellect. I loved the course and ever since I’ve grown more and more fond of WIndbg. I absolutely love how it can quickly take an issue and lead you to the core problem.
A few weeks ago, we noticed in one of our pre-production environments incrementally increasing CPU utilization in our ASP.Net application:</p>

<p><img src="/images/posts/windbg/1.jpg" alt="" /></p>

<p>Key:
* Proc - green
* %GC - purple
* Requests per second - blue
* Avg request time - red</p>

<p>Windbg works best if you have a hypothesis that you want to test. We had a few theories. Our best theory was that we had a process that gets into an infinite loop, and each time it does, it maxes another processor core (these are 8 core servers). We expected IIS to protect us from runaway requests, and if there really was an infinite loop, why weren’t we seeing a StackOverflowException, but this was still our best guess. We set out to test it.</p>

<p>First, we captured a dump by attaching Windbg to the apppool running our application. Find the process id for the app pool of interest:</p>

<p><img src="/images/posts/windbg/2.png" alt="" /></p>

<p>Then attach WinDbg to the process:</p>

<p><img src="/images/posts/windbg/3.png" alt="" /></p>

<p>Then, get the dump from Windbg by issuing</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>.dump /ma /u e:\dumps\highCpu</span></code></pre></td></tr></table></div></figure>


<p>This will create a dump file with a timestamp on the file name containing all the information we need to debug both native and managed code. We could also just do the debugging while we are attached the process, but I wanted to copy the dump off to another machine to do the analysis. Now, in Windbg, load up the dump file and psscor2:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>.load psscor2</span></code></pre></td></tr></table></div></figure>


<p>The first command I ran was !runaway. !runaway tells us the time spent by each of the processes threads executing user mode code. You can pass additional parameters to show time spent in kernel mode as well, but for this case, we’re only interested in user mode. The time reported is the time spent executing code since the thread was created. Here is the top of the results:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0:073&gt; !runaway
</span><span class='line'>User Mode Time
</span><span class='line'>Thread           Time
</span><span class='line'>33:1724          1 days 16:42:13.985
</span><span class='line'>39:17d4          1 days 15:00:01.087
</span><span class='line'>40:1a30          1 days 2:38:40.506
</span><span class='line'>34:1808          0 days 15:50:55.446
</span><span class='line'>41:174          0 days 9:35:21.695
</span><span class='line'>46:260          0 days 8:59:35.480</span></code></pre></td></tr></table></div></figure>


<p>The top three threads look interesting. That’s a lot of execution time (in fact, the top thread is almost the entire time since the last deployment). Let’s switch to thread 33 and see what we can find. I’m not including the stack trace here, but running these commands switches to the suspicious thread and shows the clr stack:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~33s 
</span><span class='line'>!clrstack</span></code></pre></td></tr></table></div></figure>


<p>What I noticed when looking at the stack of the top three threads is that they were all in the same method. Very suspicious! Looking at that method, we found this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">foo</span><span class="p">&gt;</span> <span class="n">GetAncestors</span><span class="p">(</span><span class="n">Foo</span> <span class="n">foo</span><span class="p">,</span> <span class="n">ControllerContext</span> <span class="n">controllerContext</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>   <span class="k">while</span> <span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">ParentId</span><span class="p">.</span><span class="n">HasValue</span><span class="p">)</span>
</span><span class='line'>   <span class="p">{</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">parentId</span> <span class="p">=</span> <span class="n">foo</span><span class="p">.</span><span class="n">ParentId</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
</span><span class='line'>      <span class="n">foo</span> <span class="p">=</span> <span class="n">controllerContext</span><span class="p">.</span><span class="n">GetFoo</span><span class="p">(</span><span class="n">parentId</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">foo</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>         <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">yield</span> <span class="k">return</span> <span class="n">foo</span><span class="p">;</span>
</span><span class='line'>   <span class="p">}</span>
</span><span class='line'>   <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>If there was a circular reference in a chain of Foo’s, we’d never exit this loop. The fix turned out to be easy. We keep track of which ancestors we’ve already returned, and if we come across the same one twice, we throw:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">foo</span><span class="p">&gt;</span> <span class="n">GetAncestors</span><span class="p">(</span><span class="n">Foo</span> <span class="n">foo</span><span class="p">,</span> <span class="n">ControllerContext</span> <span class="n">controllerContext</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>   <span class="kt">var</span> <span class="n">ancestorIds</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">while</span> <span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">ParentId</span><span class="p">.</span><span class="n">HasValue</span><span class="p">)</span>
</span><span class='line'>   <span class="p">{</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">parentId</span> <span class="p">=</span> <span class="n">foo</span><span class="p">.</span><span class="n">ParentId</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">ancestorIds</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">parentId</span><span class="p">))</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>      <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidOperationException</span><span class="p">(</span>
</span><span class='line'>         <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span>
</span><span class='line'>         <span class="s">&quot;There is a circular reference in the ancestors of Foo &#39;{0}&#39;.&quot;</span><span class="p">,</span>
</span><span class='line'>         <span class="n">foo</span><span class="p">.</span><span class="n">Id</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">foo</span> <span class="p">=</span> <span class="n">controllerContext</span><span class="p">.</span><span class="n">GetFoo</span><span class="p">(</span><span class="n">parentId</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">foo</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>         <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">yield</span> <span class="k">return</span> <span class="n">foo</span><span class="p">;</span>
</span><span class='line'>   <span class="p">}</span>
</span><span class='line'>   <span class="k">yield</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The investigation took all of about 15 minutes, the code fix about 10 minutes more, testing and deployed all in 5 hours. Windbg is quickly becoming one of my favorite debugging tools!</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/09/reclaiming-disk-space-from-outlook-ost-files/">Reclaiming Disk Space From Outlook OST Files</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2010-02-09T00:00:00-08:00" pubdate data-updated="true">Feb 9<span>th</span>, 2010</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>I recently received a warning for Windows telling me I was dangerously low on disk space on my laptop’s C: partition. I intentionally don’t put a lot on my C: because I like to be able to pave my machine’s OS frequently without having to worry about backing up my data, so my C: partition usually only has the OS and applications. I have 40 GB dedicated to my C: partition, and I have never bumped up against any space constratints.</p>

<p>I ran <a href="http://windirstat.info">WinDirStat</a> to see what was taking up so much space. Aside from the usual suspects (pagefile.sys and hiberfil.sys), I saw two large files, below in green (the two reds are pagefile.sys and hiberfil.sys)</p>

<p><img src="/images/posts/outlook/1.jpg" alt="" /></p>

<p>Turns out they are two OST files connected to my two Exchange accounts (Outlook 2010 lets you have multiple Exchange accounts in a single profile - very cool!). Each OST was using over 10 GB of space! I frequently archive my mail to PST files (located on another partition), so I was surprised the OST’s were so big.
The solution was to compress the OST files. I had forgotten that you can compress not only PSTs but also OSTs. Here’s the steps: (Again, this is Outlook 2010. Previous version may be slightly different.)</p>

<ol>
<li>Close Outlook.</li>
<li>Open the Mail control panel applet.</li>
<li>Click the Data Files button.</li>
<li><p>Select the file associated with your Exchange account. It’s named with your default email address.</p>

<p> <img src="/images/posts/outlook/2.jpg" alt="" /></p></li>
<li><p>Next, click the Outlook Data File Settings button.</p>

<p> <img src="/images/posts/outlook/3.jpg" alt="" /></p></li>
<li><p>Finally, click Compact Now. Sit back and wait - It takes a while. For my 10GB file, which compressed down to about 5GB, it took about 3 hours.
 <img src="/images/posts/outlook/4.jpg" alt="" /></p></li>
</ol>


<p>I was able to quickly reclaim 11GB of disk space on my C: partition by compressing my OST files. Hopefully this will help someone else with the same predicament!</p>
</div>
  
  


</div>

      </article>
    
    
      <article class="span12">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/23/subversion-error-could-not-read-status-line-connection-was-closed-by-server/">Subversion Error: Could Not Read Status Line: Connection Was Closed by Server</a></h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">paul kearney</span></span>
  

 - 
        








  


<time datetime="2010-01-23T11:00:00-08:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2010</time> - 
        


        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve recently setup a local Subversion server for a project I&#8217;m working on with some other guys. It took a bit of convincing that having multiple developers on a project requires a source control system. Prior to the past few months, there&#8217;s only been one developer working on the project (for the past 18 years!), so they&#8217;ve never needed version control. OK, well, they didn&#8217;t <em>think</em> they needed version control. Version control was simply making a copy of the folder before you start making changes.</p>

<p>I&#8217;ve not worked with Subversion much in the past, but it was super-simple to setup and get <a href="http://www.visualsvn.com">VisualSVN</a> installed and running (thanks Scott Hanselman for the <a href="http://www.hanselman.com/blog/RunningASubversionServerOffYourWindowsHomeServer.aspx">tips</a>!).</p>

<p>Anyway, I&#8217;ve been using the repository here locally via TortoiseSVN without any issues at all. I sent the connection instructions to the other guys and one of them called today saying he received an error when trying to enlist in the repository:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Could not read status line: Connection was closed by server. </span></code></pre></td></tr></table></div></figure>


<p>Ugh, I thought. Since I don&#8217;t have a lot of Subversion experience, I thought I was up against some obscure issue that would take a long time to figure out. Turns out the solution was quite simple: he was attempting to connect to the server via http, but it only accepts https connections. Putting in the correct protocol solved the problem! I do think the error could be a little more descriptive&#8230;</p>
</div>
  
  


</div>

      </article>
    
    </div>
      <div class="row">
        <ul class="pager">
          
          
            <li class="next">
              <a class="next" href="/">Newer &rarr;</a>
            </li>
          
        </ul>
      </div>
  </div>
</div>


  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">
      
        <li>
          <a href="/blog/2013/01/28/moving-from-dasblog-to-octopress-and-jekyll/">Moving from dasBlog to Octopress/Jekyll</a>
        </li>
      
        <li>
          <a href="/blog/2013/01/26/hello-world/">hello world</a>
        </li>
      
        <li>
          <a href="/blog/2012/06/04/powershell-authorizationmanager-check-failed/">Powershell AuthorizationManager check failed</a>
        </li>
      
        <li>
          <a href="/blog/2011/12/02/waze/">waze</a>
        </li>
      
        <li>
          <a href="/blog/2011/11/30/remember-controller-classes-need-to-be-public/">Remember, controller classes need to be public</a>
        </li>
      
    </ul>
    <h2><a href="/blog/archives">archives</a></h2>
  </div>
  <div class="span3">
    

  </div>
  <div class="span4">
    

  </div>
  <div class="span2">
    <h2>found on</h2>














  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  <a href="/">gravitypad.com</a>
  - Copyright &copy; 2013 - paul kearney
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
  
    <span>Designed by <a href="http://www.AdrianArtiles.com">Adrian Artiles</a>.</span>
  
</p>

  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>





</body>
</html>
