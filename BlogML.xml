<?xml version="1.0" encoding="utf-8"?><blog root-url="http://www.gravitypad.com/blog/" date-created="2013-01-28T01:14:17" xmlns="http://www.blogml.com/2006/09/BlogML" xmlns:xs="http://www.w3.org/2001/XMLSchema"><title type="text"><![CDATA[gravitypad.com]]></title><sub-title type="text"><![CDATA[home of paul kearney - technologist, .net developer, and other stuff]]></sub-title><authors><author id="pkdotnet" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true" email="paul@gravitypad.com"><title type="text"><![CDATA[Paul Kearney]]></title></author></authors><extended-properties><property name="language" value="en-us" /></extended-properties><categories><category id="apps" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[apps]]></title></category><category id="asp.net" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[asp.net]]></title></category><category id="dasBlog" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[dasBlog]]></title></category><category id="giving" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[giving]]></title></category><category id="interop" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[interop]]></title></category><category id="msnbc" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[msnbc]]></title></category><category id="outlook" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[outlook]]></title></category><category id="performance" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[performance]]></title></category><category id="tfs" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[tfs]]></title></category><category id="traffic" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[traffic]]></title></category><category id="windbg" date-created="0001-01-01T05:00:00" date-modified="0001-01-01T05:00:00" approved="true"><title type="text"><![CDATA[windbg]]></title></category></categories><posts><post id="690fe28c-a973-4792-84c5-b0920c9fe12c" date-created="2012-06-04T22:47:39" date-modified="2012-06-04T22:51:21" approved="true" post-url="http://www.gravitypad.com/blog/Powershell+AuthorizationManager+Check+Failed.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Powershell AuthorizationManager check failed]]></title><content type="text"><![CDATA[<p>While debugging some Powershell scripts today, I started getting an error:</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<pre class="brush: plain">AuthorizationManager check failed.
At C:\Users\pkearne\setupPLT.ps1:6 char:14
+ ./logging.ps1 &lt;&lt;&lt;&lt;
    + CategoryInfo      : NotSpecified: (:) [], PSSecurityException
    + FullyQualifiedErrorId : RuntimeException</pre>
<p>&nbsp;</p>
<p>After some web searching, there seems to be two primary reasons this happens:</p>
<p>&nbsp;</p>
<ul>
<li>An empty Powershell profile script</li>
<li>WMI service not running</li>
</ul>
<p><br />Neither of these cases was true for me. However, the first one pointed me in the right direction. Somehow a script I was calling out to (logging.ps1) had it's contents removed. Had the file been deleted, the error would have been that the cmdlet, function etc was not recognized. But having the file present but empty gave the misleading error "AuthorizationManager check failed".</p>
<p>&nbsp;</p>
<p>So, if you are getting this error and everything else looks correct, look and see if something similar is causing your problem.</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories /><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="481e9c7c-c96b-4603-a8c4-dbb95a44c0bb" date-created="2011-12-02T18:48:37" date-modified="2011-12-02T19:23:05" approved="true" post-url="http://www.gravitypad.com/blog/Waze+Where+Have+You+Been+All+My+Commuting+Life.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Waze, where have you been all my commuting life?]]></title><content type="text"><![CDATA[<p>A few days back on a DL I frequent, someone asked for a better traffic mobile app. The thread piqued my interest, but I really thought it would be a rehash of all the known apps out there.</p> <p>You see, I commute 25.6 miles to work. Each way. And it’s right through the middle of Seattle traffic. In 2010 Seattle ranked #10 in the nation for the worst congestion. On a good day during commute hours it will take me about 1:15 to get to work. On a bad day it can be more like 1:45. As you can see, I spend a lot of time in the car. <em>(I’ve also experimented with the Connector, Microsoft’s employee bus service, carpooling, and the Metro bus. There’s a few reasons I choose to still drive, but that’s not important right now).</em></p> <p>There were a few replies to the thread suggesting traffic apps: Google Maps, the Washington DOT app, bla bla bla. The problem is they are all terrible. Horrible. They show you traffic, but they don’t help you make any intelligent decisions about which route to take (I have three routes I can take). And they never seem to be accurate enough. There’s plenty of times I’ve been stopped in traffic while Google maps happily shows the road I am on as yellow (meaning slow, but not stopped).</p> <p>One app was mentioned that I had not heard of before: Waze (<a href="http://www.waze.com">www.waze.com</a>). The idea behind it is pretty brilliant – crowd sourced traffic. They are not the first to do it, but they’ve built a pretty cool app around the concept. </p> <p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000001_2.png"><img style="border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="shot_000001" border="0" alt="shot_000001" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000001_thumb.png" width="148" height="244"></a></p> <p>The way it works is simple – start up the app and start driving. Using your phone’s GPS, it starts uploading your position and speed to other users around you. And you get the benefit of other users’ data as well. It magically builds the traffic map based on everyone’s cumulative data.</p> <p>You can also report incidents, police activity, or unsafe conditions. Other drivers will get alerted on their devices. But Waze turns this into a bit of a game. Since anyone can report an incident, how do you know that it’s accurate? Well, as other users approach the reported location, a little popup shows up. Other users can confirm the incident or indicate it’s not there. </p> <p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000003_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="shot_000003" border="0" alt="shot_000003" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000003_thumb.png" width="148" height="244"></a></p> <p>You build up reputation by driving more miles, reporting incidents (do this safely, preferably when not driving – but it’s pretty quick and easy to do so by selecting one or two buttons – no typing needed), starting a group of fellow Wazers, or reporting map inaccuracies. </p> <p>It also figures out where you like to go and how you like to get there. Since I can drive any of three routes to get to work, it quickly shows me my three alternatives and estimated travel times for each. I can quickly select the fastest route, using real time data, without having to rely on broadly applied map colors on which to based my decision. In fact, over the last two days using the app, it has saved me about 20 minutes each day. I first opened up another traffic map, selected a route based on my usual criteria, then let Waze calculate the best route. Waze beat me both times.</p> <p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000004_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="shot_000004" border="0" alt="shot_000004" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000004_thumb.png" width="148" height="244"></a></p> <p>Another cool feature is that it can provide traffic conditions on streets that aren’t large enough for other apps to cover. For example, the DOT gets its data from sensors embedded in the pavement, but only on streets where it has sensors. Waze can give you information on any street where another user has driven. If there were enough users, you could get up to date traffic information for my very own cul-de-sac.</p> <p>There seems to be a lot more to the app than what I’ve described. I’ll admit, for now, I still open up another app to confirm Waze’s recommendations. But it’s quickly gaining my trust and confidence every day. It’s available for iPhone, Android, Blackberry and Nokia phones. Check them out at <a href="http://www.waze.com">www.waze.com</a>. </p> <p>Drive safe.</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="apps" /><category ref="traffic" /></categories><comments /><trackbacks /><attachments><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000001_thumb.png" mime-type="image/png" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000001_thumb.png" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000003_thumb.png" mime-type="image/png" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000003_thumb.png" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000004_thumb.png" mime-type="image/png" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Waze-where-have-you-been-all-my-commutin_8DE0/shot_000004_thumb.png" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="b492952c-c0fb-49aa-8c07-ea8444bf1a33" date-created="2011-11-30T23:59:00" date-modified="2011-12-02T19:00:30" approved="true" post-url="http://www.gravitypad.com/blog/Remember+Controller+Classes+Need+To+Be+Public.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Remember, controller classes need to be public]]></title><content type="text"><![CDATA[<p>File this one under Duh! I was troubleshooting a routing issue I was having with a portable area in ASP.Net MVC. For some reason I kept getting a 404. The solution was pretty big, so I created two new projects to try and isolate the problem.</p> <p>I created a new web project and a class library for the portable area. Added my routes to the area, created a new class, renamed the class MyController, wired it all up, and got the same thing.</p> <p>I installed Glimpse to see what routes were being hit. But Glimpse only works if ASP.Net handles the request, and since it was a 404, I couldn’t see the Glimpse data.</p> <p>So I installed Phil Haack’s awesome route debugger. The route debugger has a catchall route, so even if the request would result in a 404 it will return you back the debug information. I could see that the route was being hit, but it still 404’ed.</p> <p>I set breakpoints. I added some logging. Nothing would cause my controller action to get executed.</p> <p>Then it struck me. Visual Studio by default creates new classes without an access modifier, and when no access modifier is specified, the default is <strong>internal</strong>. MVC needs controller classes (and the action methods) to be <strong>public</strong> so they can be constructed via reflection.</p><pre class="brush: csharp">using System.Web.Mvc; 
namespace TestArea.Controllers
{
   public class MyController : Controller
   {
       public ActionResult Index()
       {
          return View();
       }
   }
}
</pre>
<p>The really sad part is I just helped a colleague solve the exact same problem the week before.</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="asp.net" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="1beae4e4-9e3f-42d9-b708-5f1315038db0" date-created="2011-05-13T18:01:11" date-modified="2011-05-13T18:02:05" approved="true" post-url="http://www.gravitypad.com/blog/VerificationException+Operation+Could+Destabilize+The+Runtime.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[VerificationException: Operation could destabilize the runtime]]></title><content type="text"><![CDATA[<p>I came across this exception this morning while playing with <a href="http://www.ravendb.net">RavenDB</a>. A quick search shows several people have seen this exception but not a lot of solutions.<br /><br /> I'm not sure why, but this exception in my case was related to IntelliTrace. I turned IntelliTrace off and the exception went away. Weird.<br /> <br /> BTW - this isn't related to RavenDB.&nbsp;&nbsp;&nbsp;According to <a href="http://blogs.msdn.com/b/jnak/archive/2010/07/22/verificationexception-from-windows-azure-intellitrace.aspx">http://blogs.msdn.com/b/jnak/archive/2010/07/22/verificationexception-from-windows-azure-intellitrace.aspx</a>, the issue is a bug in IntelliTrace.</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="asp.net" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="20738e99-386a-4581-a772-46faad61c0a5" date-created="2011-05-12T02:00:30" date-modified="2011-05-12T02:02:07" approved="true" post-url="http://www.gravitypad.com/blog/VB6+And+Net+Interop+Fun.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[VB6 and .Net Interop Fun]]></title><content type="text"><![CDATA[<div>&nbsp;A friend of a friend asked me to help with a project. He is a VB6 developer. Still. But he needed to incorporate a .Net component into the VB6 application in an easy way. So I've been helping him out, building up a .Net control using the <a href="http://msdn.microsoft.com/en-us/vbasic/bb419144.aspx">Microsoft Interop Toolkit</a>. It's a free add-in to Visual Studio that takes away a lot of the complexities in building COM interop components in .Net.<br /><br />Two things I learned painfully recently while helping out:<br /><ol>
<li>If your .Net control throws an exception in VB6, VB6 will report that to you as&nbsp; an "out of memory" error. That's it&nbsp;- no details, call stack, or anything else about the actual exception. Misleading and frustrating.</li>
<li>I should have remebered this one. We were getting the "out of memory" error in VB6 in design mode and couldn't figure out what the problem was. The error popped up immediately when opening the form designer in VB6. After much trouble trying to get VB6 to actually tell us what the problem is (we never got any information out of it, even after enhanced interrogation using WinDbg), it was real simple - we had a bug in a property setter. When the control was instantiated, VB6 was calling the setter, getting the exception, and then barfing with the incredibly unhelpful error message.</li>
</ol>My friends will inevitably laugh and make fun of me for playing with VB6 still. That's fine. I've found the experience has led me to develop additional skills and learn more about .Net development along the way.</div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="asp.net" /><category ref="interop" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="b88c288e-aee8-420e-82e8-2e96caf7bf63" date-created="2011-04-29T22:56:41" date-modified="2011-04-29T22:59:28" approved="true" post-url="http://www.gravitypad.com/blog/Principles+Vs+Methods+In+Software+Development.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Principles vs. Methods in Software Development]]></title><content type="text"><![CDATA[<p>&nbsp;I just posted on our&nbsp;<a title="Development@msnbc" href="http://development.msnbc.msn.com">Development@msnbc</a> blog some thoughts on Ralph Waldo Emerson's quote and it's applicability to software development.</p>
<p><br /><cite>As to methods there may be a million and then some, but principles are few. The man who grasps principles can successfully select his own methods. The man who tries methods, ignoring principles, is sure to have trouble.</cite></p>
<p><br /><cite>- Ralph Waldo Emerson (1803-1882)<br /></cite><br />Give it a read at <a href="http://development.msnbc.msn.com/_news/2011/04/29/6406331-principles-vs-methods">http://development.msnbc.msn.com/_news/2011/04/29/6406331-principles-vs-methods</a>&nbsp;and let me know what you think!</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="msnbc" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="5071d0b6-0699-4161-adaf-c22b0520b324" date-created="2011-04-05T01:30:33" date-modified="2011-04-05T01:30:33" approved="true" post-url="http://www.gravitypad.com/blog/DasBlog+Fixing+404s+For+Mapped+Urls+TinyMCE+As+The+Editor.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[DasBlog: Fixing 404’s for mapped urls, TinyMCE as the editor]]></title><content type="text"><![CDATA[<p>Two things have been bugging me since I migrated this blog over to <a href="http://dasblog.codeplex.com/">dasBlog</a>: I started getting a bunch of 404 errors for urls that are mapped to dasBlog handlers, and getting a better html editor wasn’t working.</p> <h5>404’s for things like deleteitem.aspx, blogger.aspx, etc.</h5> <p>This fix was simple. I am running this site on Windows Server 2008 R2, and the application pool was in Integrated Mode. Switching to Classic Mode got all of the handler mappings working. I’ll need to dig around in the web.config to get the handlers migrated to IIS7.5 syntax so I can go back to Integrated Mode. This fix also got comments working.</p> <h5>Setting TinyMCE as the editor</h5> <p>I had downloaded the TinyMCE editor adapter from <a href="http://www.jforsythe.com/jforsythe/proj_dasblog_addons.aspx">John Forsythe</a>, but it never worked. There seemed to be people with similar issues, but no resolution. This was even worse for me, because since I was getting 404’s for blogger.aspx, I couldn’t use Windows Live Writer either. I resorted to handcrafting my html. Yuck.</p> <p>This one was simple to fix, but I didn’t figure it out until I installed the wonderful <a href="http://code.google.com/p/elmah/">ELMAH</a>. Looking at the Elmah logs showed this error:</p> <pre class="brush: plain">tinymce\jscripts\tiny_mce\tiny_mce_gzip.aspx(5): error CS0246: The type or namespace name 'ICSharpCode' could not be found (are you missing a using directive or an assembly reference?)</pre>
<p>In the installation instructions, it said that you don’t need to install the ICSharpCode.SharpZipLib.dll, because it’s the same one installed with dasBlog. But the version of dasBlog I was running didn’t have that assembly. A quick search and download, and voilla – TinyMCE is working!</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="asp.net" /><category ref="dasBlog" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="35040f99-0556-4201-9c88-b4f251ef5d38" date-created="2011-03-31T16:27:20" date-modified="2011-03-31T21:52:48" approved="true" post-url="http://www.gravitypad.com/blog/Doh+Entity+Framework+Use+Properties+For+Your+Entities.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Doh! Entity Framework: use properties for your entities]]></title><content type="text"><![CDATA[<p>I’ve been banging my head against what seemed to be a very simple problem. Using the new Entity Framework 4.1, I created a simple entity class:

<pre class="brush: csharp">
public class ElectricityMeasurement
{
    public int Id;
    public float Kwh;
    public float Volts;
    public long Ticks;
}
</pre>
I kept getting an error complaining about no key being set for the entity:

<pre class="brush: plain">
System.Data.Entity.ModelConfiguration.ModelValidationException :
One or more validation errors were detected during model generation:

System.Data.Edm.EdmEntityType: : EntityType 'ElectricityMeasurement'
has no key defined. Define the key for this EntityType.

System.Data.Edm.EdmEntitySet: EntityType: The EntitySet ElectricityMeasurements 
is based on type ElectricityMeasurement that has no keys defined.
</pre>

But Entity Framework has conventions that should pick up the Id as the key? I even added a [Key] attribute to that property with no luck.

Then it hit me: Entity Framework works with properties, not variables:

<pre class="brush: csharp">
public class ElectricityMeasurement
{
    public int Id { get; set; }
    public float Kwh { get; set; }
    public float Volts { get; set; }
    public long Ticks { get; set; }
}
</pre>

And all is well.
</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="asp.net" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="50996d36-c7ff-4daa-85b1-fa4bc51b1cc3" date-created="2011-03-15T15:21:42" date-modified="2011-03-15T15:22:47" approved="true" post-url="http://www.gravitypad.com/blog/A+Thank+You+From+Caleb+And+The+St+Baldricks+Foundation.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[A thank you from Caleb and the St. Baldrick’s Foundation]]></title><content type="text"><![CDATA[<p><em>Thank you all again for making my head-shaving event so incredibly successful. At the last minute, "Phoebe" donated $50, bringing our total to $11,500--exactly $4000 more than I had set as a goal! Imagine my surprise when I checked the site tonight and saw that another $250 had come in! And with the matching gifts that will trickle in, St. Baldrick's made more than $17,000 from my one silly haircut.<br></em><em><br>While I'm sorry to have missed the party at Fado's, I'm glad we did it at home: Phoebe had a ton of fun sitting on my lap and cutting off individual curls to put in a bag. The curls will go out to the fairy garden tomorrow so that the faries can use them for beds.<br></em><em><br>Thank you all again, and don't be too surprised if you hear from me again in a year...<br></em></p> <p><img alt="" src="http://a1.sphotos.ak.fbcdn.net/hphotos-ak-snc6/200097_1899887538494_1280822405_2351729_713442_n.jpg"><img alt="" src="http://a5.sphotos.ak.fbcdn.net/hphotos-ak-snc6/188300_1899975420691_1280822405_2351811_4790734_n.jpg" width="331" height="603"><em></p></em> <p><em>Cheers,<br>Caleb </em></p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="giving" /></categories><comments><comment id="3de31065-ec97-4e92-bc3d-74bfcdd5e496" date-created="2012-04-03T13:59:55" date-modified="2012-04-03T13:59:55" approved="false" user-name="Arthur" user-url="http://google.com"><title type="text"><![CDATA[]]></title><content type="text"><![CDATA[_, Hello.This post was extremely remarkable, especially because I was looking for thoughts on this matter last Saturday.]]></content></comment></comments><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="b730efe0-acdb-46bf-87bd-047744619227" date-created="2011-02-24T17:08:29" date-modified="2011-03-15T15:22:57" approved="true" post-url="http://www.gravitypad.com/blog/The+Fro+Must+Go.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[The ‘Fro Must Go]]></title><content type="text"><![CDATA[<p><em>From my friend Caleb:</em></p> <p>As many of you know, my daughter is battling a rare and aggressive form of brain cancer. We’ve been fighting it for 2 years now, and continue to do so. One thing that’s become apparent is that there just hasn’t been enough money put into pediatric cancer research. <a href="http://www.stbaldricks.org/">St. Baldrick’s Foundation</a> is a non-profit foundation that has donated more money to pediatric cancer research than anyone else (except for the government). To date, they’ve raised and granted more than $56 million. The remarkable thing is that they do this by getting people like me to shave their heads—and people like you to be of a generous spirit (you can see where this is going, can’t you?)  <p>While “shaving events” happen year-round, the big events tend to be around St. Patrick’s Day. In Seattle, the event is at Fado Irish Pub, and is 2 weeks from today (march 10<sup>th</sup>). I just found out yesterday, and have decided to set an ambitious goal--$7500 in 2 weeks.&nbsp; If you feel inspired to <a href="https://www.stbaldricks.org/donate/donationinfo/participantid/436542">make a donation</a>, please do so. As you can see from the <a href="http://www.stbaldricks.org/participants/calebthompson">photo on my page</a>, my hair has become rather unruly, making the change to a shaved head more dramatic. As my wife has been saying, “the ‘fro must go!”, and what better way to get shorn?  <p>Thanks!  <p>Caleb  <p><a href="http://www.stbaldricks.org/participants/calebthompson">http://www.stbaldricks.org/participants/calebthompson</a>  <p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/The-Fro-Must-Go_805E/clip_image001_2.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="clip_image001" border="0" alt="clip_image001" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/The-Fro-Must-Go_805E/clip_image001_thumb.jpg" width="244" height="184"></a>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="giving" /></categories><comments /><trackbacks /><attachments><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/The-Fro-Must-Go_805E/clip_image001_thumb.jpg" mime-type="image/jpg" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/The-Fro-Must-Go_805E/clip_image001_thumb.jpg" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="409efb2f-0a61-4b19-972a-b6183c0f4089" date-created="2011-02-11T16:49:29" date-modified="2011-02-11T19:17:31" approved="true" post-url="http://www.gravitypad.com/blog/New+Blog+Post+Build+To+Fit.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[New blog post: Build To Fit]]></title><content type="text"><![CDATA[<p>Over at our <a href="http://development.msnbc.msn.com">Development @ msnbc</a> blog, I just blogged about <a href="http://development.msnbc.msn.com/_news/2011/02/11/5988888-build-to-fit">Build To Fit</a> – building reusable software components by starting with highly specialized ones. Check it out…</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="msnbc" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="534fef7d-2f37-4c9c-a1ca-9b97bd5dcb86" date-created="2011-02-11T01:28:33" date-modified="2011-02-11T01:28:33" approved="true" post-url="http://www.gravitypad.com/blog/New+Developer+Blog.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[New Developer Blog]]></title><content type="text"><![CDATA[<p>We just launched a new developer blog over at msnbc.com: <a href="http://development.msnbc.msn.com/">Development @ msnbc</a>. We are covering a bunch of different aspects about software development, from technical nitty-gritty on how we build and operate the software that runs our family of websites to philosophical perspectives on the softer side of development.</p> <p>Head over there and check it out. We have several authors writing there, including John Bennett, Bryan Wheeler and Peter Durham (and yours truly).</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="msnbc" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="64117cc5-24a8-4f4e-bc3b-fee1c9a54041" date-created="2011-02-08T23:22:58" date-modified="2011-02-11T19:17:47" approved="true" post-url="http://www.gravitypad.com/blog/Serving+And+Giving+Back.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Serving and Giving Back]]></title><content type="text"><![CDATA[<p><em>This is a slightly modified version of a post I made at </em><a href="http://development.msnbc.msn.com/"><em>Development@msnbc</em></a><em>.</em> <p>I'm a big fan of serving my community and supporting non-profit organizations. Serving is in our DNA as humans. We give birthday presents, give rides to the airport, cook a meal for someone in need, give time to mow someone's lawn, give our money to causes we believe in. We serve in various capacities in our communities, our churches, or maybe sit on the board of a non-profit organization. We do it because we believe it is the right thing to do. I believe we do it because it is an integral part of our beings. <p>There's so many organizations doing great and wonderful things for our communities and individuals throughout the world. Some of those organizations are large, well funded, and probably have good sized technology organizations to help support them. But there's a large number of organizations out there that are small, struggling to figure out how to spend their limited money in the most effective way for their mission. <p>A few weeks ago I participated in <a href="http://www.seattlegivecamp.org/">Seattle GiveCamp</a>. It was a part of a larger GiveCamp weekend happening in 14 cities across the United States. 2011 was the fourth year GiveCamp has been held, and there were more projects built for non-profit organizations this year than had been built in the previous three years combined. In Seattle, we had 50 volunteers working on 22 projects for 20 different local charities. We started at 5PM on Friday night and wrapped up at 5PM Sunday. My co-worker <a href="http://jtbennett.com/blog">John Bennett</a> was also signed up for the GiveCamp happening in NYC. <p>I worked on building a donor management system for two different charities: AtWork! Washington and the Haiti Sustainable Development Foundation. Both charities had been using a series of spreadsheets that were emailed among different users to keep track of their donations and donors. You can imagine the pain of trying to keep that kind of a system straight... <p>Being primarily a .Net developer, I'll admit I had a little anxiety going into the weekend. What if the team I was working with wanted to use Rails? Or Java? I figured it would be a great learning experience either way. <p>I ended up coming away having learned several things: <ul> <li>There are a lot of developers out there that have a passion for helping non-profits in their free time. This was my first time at an event like this, but many of the volunteers have done stuff like this together previously.  <li>The night before our kickoff, <a href="http://weblogs.asp.net/scottgu/archive/2011/01/13/announcing-release-of-asp-net-mvc-3-iis-express-sql-ce-4-web-farm-framework-orchard-webmatrix.aspx">Microsoft released a ton of goodies</a>: ASP.NET MVC 3, SQL Compact Edition 4, NuGet, IIS Express 7.5, WebMatrix, etc. That stuff enabled me to prototype a web based donor system in just a few hours. Awesome stuff!  <li>Build vs. Buy: Salesforce.com <a href="http://www.salesforcefoundation.org/products/nonprofit_solution">provides non-profit organizations</a> 10 user licenses for free and discounts on additional licenses. There is also an open-source <a href="http://code.google.com/p/npsp/">Non-Profit Starter Pack</a> project that applies non-profit centric customizations on top of Salesforce.com. In the end we leveraged this for our solution. Turned out all of our work was already done for us! All we needed to do was some minor customizations and prepare some training materials.  <li>Non-profits have technology needs just like businesses do. Every dollar they spend towards that necessary "stuff" is a dollar that they cannot put towards fulfilling their mission. The people who run these organizations are extremely grateful for the people who organize and work at events like GiveCamp or dotOrg Weekend. It makes their organizations more effective and able to focus on what really matters to them.  <li>Accomplishing stuff in a weekend is great. I love the fast pace and desire to get stuff done!  <li>Giving of my time is a very fulfilling act of service.</li> <li>I don’t need an excuse to serve. While GiveCamp was a great opportunity, I desire to do stuff like this more frequently and without needing a whole weekend and organization around it. Just reaching out to fill I need I see anywhere is all it takes.</li></ul> <p>Consider giving your skills and expertise to a cause that is near to your heart, or to any organization that has a need. Reach out to your neighbor or the guy you meet at the coffee shop. You really can make a big impact in your community and in the world. It just takes one. <p>Msnbc.com (my employer) has a Giving Program as one of the benefits for employees. Msnbc.com matches up to $12,000 annually for employee's cash donations to eligible organizations. What a great way to get more bang for your buck! If I give $100 to the King County Boy's and Girls Club, they actually get $200. Sweet!</p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="giving" /></categories><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="abc6e638-646a-46cf-9459-92851d7a64eb" date-created="2011-01-07T01:41:00" date-modified="2011-01-07T01:44:12" approved="true" post-url="http://www.gravitypad.com/blog/nSosumi+A+C+Port+Of+A+MobileMe+Scraper.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[nSosumi - a C# port of a MobileMe scraper]]></title><content type="text"><![CDATA[This is a C#/.Net port of Sosumi by Tyler Hall. Tyler's original PHP project can be found here: <a href="https://github.com/tylerhall/sosumi">https://github.com/tylerhall/sosumi</a><br /><br />nSosumi will allow you to programmatically retrieve your iOS device's current location, send it a message/play a sound, remotely lock or remotely wipe your iOS device. I've tested it with my iPhone 4's and an iPad, all running iOS 4.2.<br /><br />You can find the source here: <a href="http://code.google.com/p/nsosumi">http://code.google.com/p/nsosumi</a>. I'll be providing more details soon.<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/7169904575687570434-3417711206110062502?l=blog.gravitypad.com' alt='' /></div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories /><comments /><trackbacks /><attachments><attachment url="https://blogger.googleusercontent.com/tracker/7169904575687570434-3417711206110062502?l=blog.gravitypad.com" mime-type="application/octet-stream" external-uri="https://blogger.googleusercontent.com/tracker/7169904575687570434-3417711206110062502?l=blog.gravitypad.com" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="5b3f79c1-d19d-4d5f-9e3b-c11bacaa9b3e" date-created="2010-09-03T16:51:00" date-modified="2011-02-11T19:19:00" approved="true" post-url="http://www.gravitypad.com/blog/Resolving+TFS+Error+TF14087+Cannot+Undelete+X+Because+Not+All+Of+The+Deletion+Is+Being+Undeleted.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Resolving TFS error TF14087: Cannot undelete X because not all of the deletion is being undeleted]]></title><content type="text"><![CDATA[At work, we recently encountered this error in TFS when trying to merge from our trunk into a project branch. There's <a href="http://stackoverflow.com/search?q=tf14087">some </a>of <a href="http://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol/thread/b1be6b2b-f17a-49d6-ae0e-207ad9b10b6f">information </a>on the <a href="http://blogs.msdn.com/b/mrod/archive/2006/10/10/the-logic-and-reason-behind-error-message-tf14087.aspx">internet </a>about this <a href="http://geekswithblogs.net/svanvliet/archive/2007/01/14/team-foundation-server-merge-woes-tf14087.aspx">error</a>, but none of them directly applied to our issue. Thankfully, one of the benefits of having Microsoft as a parent company is access to TFS engineers.<br><br>We got into this situation when someone deleted a folder in the trunk and then re-added a folder with the same name. And then deleted it. And re-added it. When you do this without merging between the delete and adds, TFS gets real confused. It tries to merge the delete and the add (and in our case, the second delete and second add), and because they are all the same name and path, you get TF14087.<br><br>The solution (thanks George) was pretty simple:<br> <ol> <li>Get the deleted id for all of the deletes of the folder:<br>tf dir /recursive /deleted /slotmode $/project/trunk. <br><br>This gives output like:<br><pre class="brush: plain">$/project/trunk:
$Build
$Configs
$Databases
$Deploy
$Docs
$External
$Folder
$Folder;X246937
$Folder;X246938
</pre>In our case, there are three entries for $Folder, two with deleted ids, and the one folder that has not been deleted (the last add).
<li>Destroy the deleted folders by using their deleted ids.<pre class="brush: plain">tf destroy /preview $/ijv/trunk/folder;X246937
</pre>Adding the /preview argument let's you confirm what would be done when issuing the destroy command. After you review the output and make sure you're not destroying something you don't mean to, remove the /preview and run the command.<br><br>Then we run it for the other deleted id:<pre class="brush: plain">tf destroy /preview $/ijv/trunk/folder;X246938
</pre>
<li>Finally, do the merge from the trunk back into the project branch.</li></ol>That resolved the issue for us. We lost the history of the original two versions of that folder, but it did allow us to move forward with merging. Hopefully this information will help someone when trying to resolve the same issue.
<div class="blogger-post-footer"><img alt="" src="https://blogger.googleusercontent.com/tracker/7169904575687570434-4553903616832549504?l=blog.gravitypad.com" width="1" height="1"></div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="tfs" /></categories><comments /><trackbacks /><attachments><attachment url="https://blogger.googleusercontent.com/tracker/7169904575687570434-4553903616832549504?l=blog.gravitypad.com" mime-type="application/octet-stream" external-uri="https://blogger.googleusercontent.com/tracker/7169904575687570434-4553903616832549504?l=blog.gravitypad.com" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="c8ec2465-6ec7-4bab-bc99-06c1dba986a5" date-created="2010-05-26T18:55:00" date-modified="2011-02-11T19:20:03" approved="true" post-url="http://www.gravitypad.com/blog/My+Love+Affair+With+WinDbg+Or+High+CPU+Utilization+In+ASPNet+And+The+Runaway+Iterator.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[My love affair with WinDbg (or high CPU utilization in ASP.Net and the runaway iterator)]]></title><content type="text"><![CDATA[<p>A while back I attended a “Debugging .Net Applications” course taught by <a href="http://www.wintellect.com/CS/blogs/jrobbins/default.aspx">John Robbins</a> from <a href="http://www.blogger.com/www.wintellect.com">Wintellect</a>. I loved the course and ever since I’ve grown more and more fond of WIndbg. I absolutely love how it can quickly take an issue and lead you to the core problem. </p> <p>A few weeks ago, we noticed in one of our pre-production environments incrementally increasing CPU utilization in our ASP.Net application: </p> <p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg1_2.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="windbg1" border="0" alt="windbg1" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg1_thumb.jpg" width="416" height="158"></a>&nbsp;</p><pre>Key: <br>Proc - green <br>%GC - purple <br>Requests per second - blue <br>Avg request time - red</font></pre><br><br>
<p>Windbg works best if you have a hypothesis that you want to test. We had a few theories. Our best theory was that we had a process that gets into an infinite loop, and each time it does, it maxes another processor core (these are 8 core servers). We expected IIS to protect us from runaway requests, and if there really was an infinite loop, why weren’t we seeing a StackOverflowException, but this was still our best guess. We set out to test it. </p><br><br>
<p>First, we captured a dump by attaching Windbg to the apppool running our application. Find the process id for the app pool of interest:</p>
<p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg2_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="windbg2" border="0" alt="windbg2" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg2_thumb.png" width="479" height="61"></a>&nbsp;</p><br><br>
<p>Then attach WinDbg to the process: <br><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg3_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="windbg3" border="0" alt="windbg3" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg3_thumb.png" width="333" height="479"></a><br><br><br>Then, get the dump from Windbg by issuing </p><br><br><pre class="brush: plain">.dump /ma /u e:\dumps\highCpu</pre><br>This will create a dump file with a timestamp on the file name containing all the information we need to debug both native and managed code. We could also just do the debugging while we are attached the process, but I wanted to copy the dump off to another machine to do the analysis. Now, in Windbg, load up the dump file and <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=5c068e9f-ebfe-48a5-8b2f-0ad6ab454ad4">psscor2</a>: <br><br><pre class="brush: plain">.load psscor2</pre><br>The first command I ran was !runaway. !runaway tells us the time spent by each of the processes threads executing user mode code. You can pass additional parameters to show time spent in kernel mode as well, but for this case, we’re only interested in user mode. The time reported is the time spent executing code since the thread was created. Here is the top of the results: <br><br><pre class="brush: plain">0:073&gt; !runaway<br>User Mode Time<br>Thread           Time<br>33:1724          1 days 16:42:13.985<br>39:17d4          1 days 15:00:01.087<br>40:1a30          1 days 2:38:40.506<br>34:1808          0 days 15:50:55.446<br>41:174          0 days 9:35:21.695<br>46:260          0 days 8:59:35.480</pre><br>The top three threads look interesting. That’s a lot of execution time (in fact, the top thread is almost the entire time since the last deployment). Let’s switch to thread 33 and see what we can find. I’m not including the stack trace here, but running these commands switches to the suspicious thread and shows the clr stack: <br><br><pre class="brush: plain">~33s <br>!clrstack</pre><br>What I noticed when looking at the stack of the top three threads is that they were all in the same method. Very suspicious! Looking at that method, we found this: <br><br><pre class="brush: csharp">private static IEnumerable<foo> GetAncestors(Foo foo, ControllerContext controllerContext)<br>{<br>   while (foo.ParentId.HasValue)<br>   {<br>      int parentId = foo.ParentId.Value;<br>      foo = controllerContext.GetFoo(parentId, true);<br>   <br>      if (foo == null)<br>      {<br>         yield break;<br>      }<br>   <br>      yield return foo;<br>   }<br>   yield break;<br>}</pre><br>If there was a circular reference in a chain of Foo’s, we’d never exit this loop. The fix turned out to be easy. We keep track of which ancestors we’ve already returned, and if we come across the same one twice, we throw: <br><br><pre class="brush: csharp">private static IEnumerable<foo> GetAncestors(Foo foo, ControllerContext controllerContext)<br>{<br>   var ancestorIds = new HashSet<int>();<br>   <br>   while (foo.ParentId.HasValue)<br>   {<br>      int parentId = foo.ParentId.Value;<br>   <br>      if (ancestorIds.Contains(parentId))<br>      {<br>      throw new InvalidOperationException(<br>         string.Format(<br>         "There is a circular reference in the ancestors of Foo '{0}'.",<br>         foo.Id));<br>      }<br>   <br>      foo = controllerContext.GetFoo(parentId, true);<br>   <br>      if (foo == null)<br>      {<br>         yield break;<br>      }<br>    <br>      yield return foo;<br>   }<br>   yield break;<br>}</pre><br>The investigation took all of about 15 minutes, the code fix about 10 minutes more, testing and deployed all in 5 hours. Windbg is quickly becoming one of my favorite debugging tools! <br><br>
<div class="blogger-post-footer"><img alt="" src="https://blogger.googleusercontent.com/tracker/7169904575687570434-1596035640320332649?l=blog.gravitypad.com" width="1" height="1"></div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="asp.net" /><category ref="performance" /><category ref="windbg" /></categories><comments /><trackbacks /><attachments><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg1_thumb.jpg" mime-type="image/jpg" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg1_thumb.jpg" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg2_thumb.png" mime-type="image/png" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg2_thumb.png" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg3_thumb.png" mime-type="image/png" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/My-love-aff.Net-and-the-runaway-iterator_11A7B/windbg3_thumb.png" embedded="false" /><attachment url="https://blogger.googleusercontent.com/tracker/7169904575687570434-1596035640320332649?l=blog.gravitypad.com" mime-type="application/octet-stream" external-uri="https://blogger.googleusercontent.com/tracker/7169904575687570434-1596035640320332649?l=blog.gravitypad.com" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="5fa01739-df54-469b-992d-0bb381ec9781" date-created="2010-02-09T20:19:00" date-modified="2011-02-11T19:19:48" approved="true" post-url="http://www.gravitypad.com/blog/Reclaiming+Disk+Space+From+Outlook+OST+Files.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Reclaiming disk space from Outlook OST files]]></title><content type="text"><![CDATA[<p>I recently received a warning for Windows telling me I was dangerously low on disk space on my laptop’s C: partition. I intentionally don’t put a lot on my C: because I like to be able to pave my machine’s OS frequently without having to worry about backing up my data, so my C: partition usually only has the OS and applications. I have 40 GB dedicated to my C: partition, and I have never bumped up against any space constratints.</p> <p>I ran <a href="http://windirstat.info/">WinDirStat</a> to see what was taking up so much space. Aside from the usual suspects (pagefile.sys and hiberfil.sys), I saw two large files, below in green (the two reds are pagefile.sys and hiberfil.sys)</p> <p><a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook1_2.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="outlook1" border="0" alt="outlook1" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook1_thumb.jpg" width="499" height="320"></a></p> <p>Turns out they are two OST files connected to my two Exchange accounts (Outlook 2010 lets you have multiple Exchange accounts in a single profile - very cool!). Each OST was using over 10 GB of space! I frequently archive my mail to PST files (located on another partition), so I was surprised the OST’s were so big.</p> <p>The solution was to compress the OST files. I had forgotten that you can compress not only PSTs but also OSTs. Here’s the steps: (Again, this is Outlook 2010. Previous version may be slightly different.)</p> <ol> <li>Close Outlook.  <li>Open the Mail control panel applet.  <li>Click the Data Files button.  <li>Select the file associated with your Exchange account. It’s named with your default email address. </li></ol> <p>&nbsp;<a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook2_2.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="outlook2" border="0" alt="outlook2" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook2_thumb.jpg" width="472" height="390"></a></p> <p>5. Next, click the Outlook Data File Settings button.</p> <p>&nbsp;<a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook3_2.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="outlook3" border="0" alt="outlook3" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook3_thumb.jpg" width="376" height="477"></a></p> <p>6. Finally, click Compact Now. Sit back and waitâ€¦ It takes a while. For my 10GB file, which compressed down to about 5GB, it took about 3 hours.</p> <p>&nbsp;<a href="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook4_2.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="outlook4" border="0" alt="outlook4" src="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook4_thumb.jpg" width="376" height="193"></a></p>    <p>I was able to quickly reclaim 11GB of disk space on my C: partition by compressing my OST files. Hopefully this will help someone else with the same predicament!</p> <div class="blogger-post-footer"><img alt="" src="https://blogger.googleusercontent.com/tracker/7169904575687570434-3723059641533747163?l=blog.gravitypad.com" width="1" height="1"></div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories><category ref="outlook" /><category ref="performance" /></categories><comments><comment id="6d4ef8d1-b5cb-4a10-bc46-699f7404cf0d" date-created="2012-11-06T11:17:26" date-modified="2012-11-06T11:17:26" approved="true" user-name="www.google.com/accounts/o8/id?id=AItOawmt9DnT-v8SxeQW_3cddDqhtWyV30iIXj0" user-url="http://www.google.com/accounts/o8/id?id=AItOawmt9DnT-v8SxeQW_3cddDqhtWyV30iIXj0" user-email="none@none.com"><title type="text"><![CDATA[]]></title><content type="text"><![CDATA[Thanks!
Last time I compacted OST was about 3 years ago and I forgot where the option was. You saved me some time!]]></content></comment></comments><trackbacks /><attachments><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook1_thumb.jpg" mime-type="image/jpg" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook1_thumb.jpg" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook2_thumb.jpg" mime-type="image/jpg" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook2_thumb.jpg" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook3_thumb.jpg" mime-type="image/jpg" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook3_thumb.jpg" embedded="false" /><attachment url="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook4_thumb.jpg" mime-type="image/jpg" external-uri="http://www.gravitypad.com/blog/content/binary/Windows-Live-Writer/Reclaiming-disk-space-from-Outlook-OST-f_11AEB/outlook4_thumb.jpg" embedded="false" /><attachment url="https://blogger.googleusercontent.com/tracker/7169904575687570434-3723059641533747163?l=blog.gravitypad.com" mime-type="application/octet-stream" external-uri="https://blogger.googleusercontent.com/tracker/7169904575687570434-3723059641533747163?l=blog.gravitypad.com" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="84ffb6af-dc64-40f2-8411-e66b8444e0eb" date-created="2010-01-24T00:18:00" date-modified="2010-01-24T00:34:25" approved="true" post-url="http://www.gravitypad.com/blog/Subversion+Error+Could+Not+Read+Status+Line+Connection+Was+Closed+By+Server.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Subversion error: Could not read status line: Connection was closed by server]]></title><content type="text"><![CDATA[I've recently setup a local Subversion server for a project I'm working on with some other guys. It took a bit of convincing that having multiple developers on a project requires a source control system. Prior to the past few months, there's only been one developer working on the project (for the past 18 years!), so they've never needed version control. OK, well, they didn't *think* they needed version control. Version control was simply making a copy of the folder before you start making changes.  <br />  <br />I've not worked with Subversion much in the past, but it was super-simple to setup and get <a href="http://www.visualsvn.com/">VisualSVN</a> installed and running (thanks Scott Hanselman for the <a href="http://www.hanselman.com/blog/RunningASubversionServerOffYourWindowsHomeServer.aspx">tips</a>!).  <br />  <br />Anyway, I've been using the repository here locally via TortoiseSVN without any issues at all. I sent the connection instructions to the other guys and one of them called today saying he received an error when trying to enlist in the repository:  <br />  <br /><font face="Courier New">Could not read status line: Connection was closed by server.   <br /></font>  <br />Ugh, I thought. Since I don't have a lot of Subversion experience, I thought I was up against some obscure issue that would take a long time to figure out. Turns out the solution was quite simple: he was attempting to connect to the server via http, but it only accepts https connections. Putting in the correct protocol solved the problem! I do think the error could be a little more descriptive...    <div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/7169904575687570434-6389443400572379269?l=blog.gravitypad.com' alt='' /></div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories /><comments /><trackbacks /><attachments><attachment url="https://blogger.googleusercontent.com/tracker/7169904575687570434-6389443400572379269?l=blog.gravitypad.com" mime-type="application/octet-stream" external-uri="https://blogger.googleusercontent.com/tracker/7169904575687570434-6389443400572379269?l=blog.gravitypad.com" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="d6cc6243-ec10-49cd-a46f-151d2bf7937a" date-created="2010-01-15T09:00:00" date-modified="2010-01-15T09:00:58" approved="true" post-url="http://www.gravitypad.com/blog/Hello+World.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Hello World]]></title><content type="text"><![CDATA[Every new blog needs a Hello World post...<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/7169904575687570434-3250966843630696965?l=blog.gravitypad.com' alt='' /></div>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories /><comments /><trackbacks /><attachments><attachment url="https://blogger.googleusercontent.com/tracker/7169904575687570434-3250966843630696965?l=blog.gravitypad.com" mime-type="application/octet-stream" external-uri="https://blogger.googleusercontent.com/tracker/7169904575687570434-3250966843630696965?l=blog.gravitypad.com" embedded="false" /></attachments><authors><author ref="pkdotnet" /></authors></post><post id="819e0c5a-4b3d-44b5-8548-802bcab5ca5f" date-created="2010-01-01T03:26:32" date-modified="2011-02-09T03:27:57" approved="true" post-url="http://www.gravitypad.com/blog/Projects+Ive+Worked+On.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[Projects I've Worked On]]></title><content type="text"><![CDATA[•msnbc.com brand family 
I am currently the Platform Architect for the content publishing platform at MSNBC Interactive. I led the Publishing Platform team through several strategic product cycles, culminating in a complete rearchitecture of msnbc’s content management system. Focused on delivery of high scale, highly available publishing software that enables delivery of 2.5+B page views/month to over 120M unique users. I managed 13 direct and 10 indirect professionals at 4 locations with a $2.5M operating budget, reporting to Vice President, Technology.

Key accomplishments included:

•Led the rearchitecture of msnbc.com’s publishing platform from an n-tier application into a queue based service-oriented architecture, resulting in reduced software complexity and risk with increased reusability, throughput and developer productivity. Focused on interoperability between different technical platforms, including those of newsvine.com and everyblock.com, both Linux/Java platforms. 
•We reduced datacenter footprint by 80% by designing and implementing key architectural changes, while increasing system availability to 99.95+%. 
•I was the software engineer for our content relevance engine, which recommends multimedia content related to a piece of media an end user or editor is viewing without manual processes. 
•Developed system for automated deployment of database scripts to multi-tier, partitioned database environments. 
•I drove change in msnbc’s SDLC from a waterfall to lean/agile methodology, focused on incremental delivery of business value early and frequently while removing process waste. 

•I was a contributor to strategic exploration of new lines of business, including repurposing existing systems into a SAAS business unit.

•I am a consistent achiever of 90%+ affirmative scores in our annual employee survey.

Our publishing platform hosts many high-volume news sites, including:

•www.msnbc.msn.com 
•www.cnbc.com 
•www.todayshow.com 
•www.nbcsports.com 
•www.nightlynews.msnbc.com 
•www.dateline.msnbc.com 
•www.ntvmsnbc.com 
•www.meetthepress.msnbc.com 
 

•Regus online CMS and reservation system 
www.regus.com 
•xbox.com 
xbox.com Content Management System and service intergration with Xbox Live

www.xbox.com

•Nestle Waters North America 
Online billing/customer service and marketing sites

http://www.arrowheadwater.com/

http://www.deerparkwater.com/

http://www.ozarkawater.com/

http://www.icemountainwater.com/

http://www.polandspring.com/

http://www.zephyrhillswater.com/

•McKinsley Quarterly 
McKinsley Quarterly online CMS site 
•MSN Direct Marketing 
Content management system for MSN Direct marketing site

www.msndirect.com

•MSN Direct watch face development 
Implementation of 12 different watch faces for MSN Direct watches, developed using Microsoft .Net Tiny CLR. 

Here's a few:

]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories /><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post><post id="6c050afc-4f68-4193-bed1-28816d266ae3" date-created="2010-01-01T03:23:46" date-modified="2011-02-09T03:24:12" approved="true" post-url="http://www.gravitypad.com/blog/About+Me.aspx" type="normal" hasexcerpt="true" views="0"><title type="text"><![CDATA[About Me]]></title><content type="text"><![CDATA[<p>I work for </span><a href="http://www.msnbc.msn.com/">msnbc.com</a><span style="color: black;">, where I am currently employed as a Platform Architect. We are responsible for the content management and publishing system that powers the MSNBC family of websites, including </span><a href="http://www.cnbc.com/">cnbc.com</a><span style="color: black;">, </span><a href="http://www.nbcsports.com/">nbcsports.com</a><span style="color: black;">, </span><a href="http://www.todayshow.com/">todayshow.com</a><span style="color: black;">, plus a whole host of other high profile news sites. Our publishing platform serves over 2.5 billion page views per month with over 99.95% site availability. And while we use a lot of Microsoft technologies, we also integrate with some of our acquisitions who run on Linux. There's a whole host of technological challenges associated with keeping a high volume site running 24X7 with content that rapidly changes (ie the news), and that's what gets me up and going to work every morning.</span></p> <p style="margin: 0in; font-family: georgia; color: black; font-size: 10pt;"> </p> <p><span style="color: black;">I am currently enrolled at </span><a href="http://www.wsu.edu/">Washington State University</a><span style="color: black;"> in the Distance Degree Program. I am currently a junior seeking to complete my Bachelor's degree in Business Administration, Management and Operations with a minor in Entreprenurism. I was enrolled at the </span><a href="http://www.unm.edu/">University of New Mexico </a><span style="color: black;">back in the 1990's, but left to start my own consulting business. I recently decided it was time to go back and complete what I had started - not realizing just how much course work would not transfer and need to be redone. Nonetheless, I am progressing quickly through my classes and am enjoying the educational experience. Heck, I even made the </span><a href="http://president.wsu.edu/office/awards/honor-roll/2009SpringWesternWA.html">President's</a><span style="color: black;"> </span><a href="http://www.edmondsbeacon.com/index.php?option=com_content&amp;view=article&amp;id=1866:edmonds-students-make-wsu-honor-roll&amp;catid=103&amp;Itemid=196">Honor Roll </a><span style="color: black;">last semester.</span></p>]]></content><post-name type="text"><![CDATA[]]></post-name><excerpt type="text"><![CDATA[]]></excerpt><categories /><comments /><trackbacks /><attachments /><authors><author ref="pkdotnet" /></authors></post></posts></blog>